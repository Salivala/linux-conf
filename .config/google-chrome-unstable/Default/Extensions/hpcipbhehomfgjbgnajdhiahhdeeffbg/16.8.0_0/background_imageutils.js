function convertStringToArrayBufferView(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}function ScreenleapUtils(){this.getTotalArea=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n].width*t[n].height;return e},this.dataUrisToUint8Array=function(t){for(var e=[],n=0,r=[],a=0;a<t.length;a++){for(var i=t[a],o=window.atob(i),s=new window.Uint8Array(o.length),h=0;h<o.length;h++)s[h]=o.charCodeAt(h);e.push(s),r.push(s.byteLength),n+=s.byteLength}return{uint8Arrays:e,lengths:r,contentLength:n}},this.convertDataUrlToBinary=function(t){return this.convertDataUrlsToUint8Array([t])};this.extractBase64Datas=function(t,e){for(var n,r=-1!=(n=t[0],n.split(",")[0]).indexOf("jpeg")?"image/jpeg":"image/png",a=0;a<t.length;a++)e.push(t[a].split(",")[1]);return r},this.convertDataUrlsToUint8Array=function(t){var e,n=[],r=this.extractBase64Datas(t,n),a=this.dataUrisToUint8Array(n),i=a.uint8Arrays;if(i.length>1){var o=0;for(e=0;e<i.length;e++)o+=i[e].byteLength;var s=new window.Uint8Array(o),h=0;for(e=0;e<i.length;e++)s.set(i[e],h),h+=i[e].byteLength}else s=i[0];return{data:s,contentType:r,lengths:a.lengths,contentLength:a.contentLength}},this.combineMarkupCodeAndImageData=function(t,e,n){var r=null;if(t>0){(r=screenleapUtils.convertDataUrlToBinary(n)).params={imageContentType:r.contentType,imageContentLength:r.contentLength,markupCodeLength:e.length},r.headers={};var a=convertStringToArrayBufferView(e);r.params.markupCodeLength=a.length;var i=new window.Blob([a,r.data]);r.data=i,r.contentType="application/octet-stream",r.headers.contentLength=i.size}return r},this.ajax=function(t,e,n){if(t.params){for(var r in t.url+="?",t.params)t.url+=r+"="+encodeURIComponent(t.params[r])+"&";t.url=t.url.slice(0,t.url.length-1)}t.type||(t.type="GET"),"GET"==t.type&&(t.url+=(-1==t.url.indexOf("?")?"?":"&")+(new Date).getTime());var a=new XMLHttpRequest;if(a.url=t.url,a.open(t.type,t.url,!0),a.ontimeout=function(){console.log("timeout ("+this.timeout+") while calling "+t.url),n&&n(this,!0),a=null},a.timeout=t.timeout?t.timeout:3e4,t.data&&a.setRequestHeader("Content-type",t.contentType||"application/x-www-form-urlencoded"),t.headers)for(var i in t.headers)a.setRequestHeader(i,t.headers[i]);a.onreadystatechange=function(){4==a.readyState&&(200==a.status?e&&e(a.responseText,a):n&&n(a),a=null)},a.send(t.data)},this.convertStringToUint8Array=function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e},this.appendUint8Arrays=function(t,e){var n=new window.Uint8Array(t.byteLength+e.byteLength);return n.set(new window.Uint8Array(t),0),n.set(new window.Uint8Array(e),t.byteLength),n.buffer}}var screenleapUtils=new ScreenleapUtils;