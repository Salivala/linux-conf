var account={userInfo:null,webBaseUrl:"http://www.screenleap.com",webBaseApiUrl:"https://www.screenleap.com/v2",canvas:null,getIsAuthenticated:function(){return null!=this.userInfo},getUserInfo:function(){return this.userInfo},getUserId:function(){return this.userInfo?this.userInfo.userId:null},getScreenleapSiteUrl:function(){var e=getUserInfo();return e?this.webBaseApiUrl+"/home?userId="+e.userId+"&token="+e.token:this.webBaseUrl+"/"},getAutoLoginAttempted:function(){return this.autoLoginAttempted},setAutoLoginAttempted:function(e){this.autoLoginAttempted=e},signIn:function(e,t,n,r,s){var i=this,o={emailAddress:e,password:t};n&&(o.screenshotId=n),screenleapUtils.ajax({url:this.webBaseApiUrl+"/authenticate",params:o,type:"POST"},function(t){i.userInfo=JSON.parse(t),r&&r(i.userInfo,i.userInfo.screenshotSetId),e&&-1!=e.indexOf("@screenleap.com")&&dispatch.triggerOnAllTabs("screenleapUserAuthenticated")},function(e){s&&s(e)})},createAccountAndSignin:function(e,t,n,r){var s=this;t&&(e.screenshotId=t),e.doSignIn=!0,screenleapUtils.ajax({url:this.webBaseApiUrl+"/signup",params:e,type:"POST"},function(e){s.userInfo=JSON.parse(e),n&&n(s.userInfo,s.userInfo.screenshotSetId)},function(e){r&&r(e)})},signInWithToken:function(e,t,n,r){var s=this;screenleapUtils.ajax({url:this.webBaseApiUrl+"/authenticate-with-auto-login-token",params:{userId:e,token:t},type:"POST"},function(e){s.userInfo=JSON.parse(e),n&&n(s.userInfo)},function(e){r&&r(e)})},signOut:function(){this.reset()},reset:function(){this.userInfo=null},getTimezone:function(){var e=new Date;return"function"==typeof e.getTimezoneOffset?60*e.getTimezoneOffset()*1e3*-1:null},createMeeting:function(e,t,n){if(this.userInfo){e.audioConferencingMethod="STANDARD";var r={userId:this.userInfo.userId,token:this.userInfo.token,timezoneoffset:this.getTimezone()};screenleapUtils.ajax({url:this.webBaseUrl+"/ext/meetings",params:e,headers:r,type:"POST"},function(e){var t=JSON.parse(e),n="Please join my Screenleap meeting: "+t.meetingLink+".\n\nTo join the audio conference, call "+t.dialInNumber+" and enter "+t.conferenceId+' followed by "#". See dial-in numbers for other countries: http://www.screenleap.com/conference-call-numbers\n\nMeeting ID: '+t.meetingCode;dispatch.triggerOnAllTabs("meetingCreated",{description:n})},function(e){var t;t=403==e.status?"Please upgrade to a Pro account in order to have access to this feature.":"There is a problem with the feature you are trying to access. Support has been notified with the details of the problem and they will be addressing it shortly. We apologize for the inconvenience.",dispatch.triggerOnAllTabs("meetingError",{errorText:t})})}else n(),dispatch.triggerOnAllTabs("meetingError",{errorText:"Please sign in to use this feature."})}};function getUserInfo(){return account.userInfo}